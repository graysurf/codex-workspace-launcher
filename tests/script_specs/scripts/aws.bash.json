{
  "smoke": [
    {
      "name": "ls",
      "command": ["bash", "-c", "source scripts/aws.bash; aws ls"],
      "timeout_sec": 10,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)\\bdocker\\b.*\\brun\\b.*--rm.*-v\\n/var/run/docker.sock:/var/run/docker.sock.*-e\\nGH_TOKEN.*-e\\nGITHUB_TOKEN.*graysurf/agent-workspace-launcher:latest.*\\bls\\b"
      }
    },
    {
      "name": "create",
      "command": ["bash", "-c", "source scripts/aws.bash; aws create octo/demo"],
      "timeout_sec": 10,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)\\bdocker\\b.*\\brun\\b.*--rm.*-v\\n/var/run/docker.sock:/var/run/docker.sock.*-e\\nGH_TOKEN.*-e\\nGITHUB_TOKEN.*graysurf/agent-workspace-launcher:latest.*\\bcreate\\b.*octo/demo"
      }
    },
    {
      "name": "exec",
      "command": ["bash", "-c", "source scripts/aws.bash; aws exec ws-smoke ls"],
      "timeout_sec": 10,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)\\bdocker\\b.*\\brun\\b.*--rm.*-v\\n/var/run/docker.sock:/var/run/docker.sock.*-e\\nGH_TOKEN.*-e\\nGITHUB_TOKEN.*graysurf/agent-workspace-launcher:latest.*\\bexec\\b.*\\bws-smoke\\b.*\\bls\\b"
      }
    },
    {
      "name": "rm",
      "command": ["bash", "-c", "source scripts/aws.bash; aws rm ws-smoke --yes"],
      "timeout_sec": 10,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)\\bdocker\\b.*\\brun\\b.*--rm.*-v\\n/var/run/docker.sock:/var/run/docker.sock.*-e\\nGH_TOKEN.*-e\\nGITHUB_TOKEN.*graysurf/agent-workspace-launcher:latest.*\\brm\\b.*\\bws-smoke\\b.*--yes"
      }
    },
    {
      "name": "reset",
      "command": ["bash", "-c", "source scripts/aws.bash; aws reset repo ws-smoke"],
      "timeout_sec": 10,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)\\bdocker\\b.*\\brun\\b.*--rm.*-v\\n/var/run/docker.sock:/var/run/docker.sock.*-e\\nGH_TOKEN.*-e\\nGITHUB_TOKEN.*graysurf/agent-workspace-launcher:latest.*\\breset\\b.*\\brepo\\b.*\\bws-smoke\\b"
      }
    },
    {
      "name": "tunnel",
      "command": ["bash", "-c", "source scripts/aws.bash; aws tunnel ws-smoke --detach"],
      "timeout_sec": 10,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)\\bdocker\\b.*\\brun\\b.*--rm.*-v\\n/var/run/docker.sock:/var/run/docker.sock.*-e\\nGH_TOKEN.*-e\\nGITHUB_TOKEN.*graysurf/agent-workspace-launcher:latest.*\\btunnel\\b.*\\bws-smoke\\b.*--detach"
      }
    },
    {
      "name": "auth-gpg",
      "command": ["bash", "-c", "source scripts/aws.bash; aws auth gpg --key DEADBEEF ws-smoke"],
      "timeout_sec": 10,
      "expect": {
        "exit_codes": [0],
        "stdout_regex": "(?s)\\bdocker\\b.*\\brun\\b.*--rm.*-v\\n/var/run/docker.sock:/var/run/docker.sock.*-e\\nGH_TOKEN.*-e\\nGITHUB_TOKEN.*-e\\nAGENT_WORKSPACE_GPG_KEY.*graysurf/agent-workspace-launcher:latest.*\\bauth\\b.*\\bgpg\\b.*--key.*DEADBEEF.*\\bws-smoke\\b"
      }
    }
  ]
}
